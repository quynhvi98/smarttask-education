<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout">
<head>
    <title>Smarttask Education</title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- style sheet -->
    <link rel="stylesheet" type="text/css" th:href="@{/css/bootstrap-3.3.7/bootstrap.min.css}"/>
    <link rel="stylesheet" type="text/css" th:href="@{/css/bootstrap-datepicker3.min.css}"/>
    <link rel="stylesheet" type="text/css" th:href="@{/js/plugins/daterangepicker/daterangepicker.css}"/>
    <link rel="stylesheet" type="text/css" th:href="@{/css/datatables.min.css}"/>
    <link rel="stylesheet" type="text/css" th:href="@{/css/login.css}"/>
    <link rel="stylesheet" type="text/css" th:href="@{/css/select2.min.css}"/>
    <!-- thu vien validate -->
    <link rel="stylesheet" type="text/css" th:href="@{/css/parsley.css}"/>
    <link rel="stylesheet" type="text/css" th:href="@{/css/bootstrap-datepicker.min.css}">
    <link rel="stylesheet" type="text/css" th:href="@{/css/font-awesome.min.css}"/>
    <link rel="stylesheet" type="text/css" th:href="@{/css/font-awesome-animation.min.css}"/>
    <link rel="stylesheet" type="text/css" th:href="@{/css/ionicons.min.css}"/>
    <link rel="stylesheet" type="text/css" th:href="@{/css/admin-lte.min.css}"/>
    <link rel="stylesheet" type="text/css" th:href="@{/css/ionicons.min.css}"/>
    <link rel="stylesheet" type="text/css" th:href="@{/css/main.css}"/>
    <link rel="stylesheet" type="text/css" th:href="@{/css/sweetalert.css}"/>
    <link rel="stylesheet" type="text/css" th:href="@{/css/lobibox.min.css}"/>
    <!-- css overwrite -->
    <link rel="stylesheet" type="text/css" th:href="@{/css/overwrite.css}"/>
    <link rel="stylesheet" type="text/css" th:href="@{/css/fixgiaodienadmin.css}">
    <link rel="stylesheet" type="text/css" th:href="@{/css/fixpopup.css}"/>
    <!-- jquery -->
    <script type="text/javascript" th:src="@{/js/jquery-3.3.1/jquery.min.js}"></script>
    <script type="text/javascript" th:src="@{/js/bootstrap-3.3.7/bootstrap.min.js}"></script>
    <script type="text/javascript" th:src="@{/js/jquery.slimscroll-1.3.6.min.js}"></script>
    <script type="text/javascript" th:src="@{/js/fastclick-1.0.6.min.js}"></script>
    <script type="text/javascript" th:src="@{/js/parsley/parsley.js}"></script>

    <script type="text/javascript" th:src="@{/js/select2/select2.full.min.js}"></script>
    <script type="text/javascript" th:src="@{/js/bootstrap-datepicker.min.js}"></script>
    <script type="text/javascript" th:src="@{/js/plugins/daterangepicker/moment.js}"></script>
    <script type="text/javascript" th:src="@{/js/plugins/daterangepicker/daterangepicker.js}"></script>
    <script type="text/javascript" th:src="@{/js/app.min.js}"></script>
    <script type="text/javascript" th:src="@{/js/javascript.js}"></script>
    <script type="text/javascript" th:src="@{/js/sweetalert.js}"></script>
    <script type="text/javascript" th:src="@{/js/lobibox.js}"></script>
    <script type="text/javascript" th:src="@{/js/lobibox.min.js}"></script>
    <script type="text/javascript" th:src="@{/js/datatables.min.js}"></script>
    <script type="text/javascript" th:src="@{/js/datatables.config.js}"></script>
    <script type="text/javascript" th:src="@{/js/cuttom.js}"></script>
    <script type="text/javascript" th:src="@{/js/trongtran.js}"></script>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
</head>
<body class="hold-transition fixed skin-purple sidebar-mini">
<div class="wrapper">
    <div th:replace="fragments/header :: header">&nbsp;</div>
    <div class="content-wrapper">
        <!--<div layout:fragment="content">&nbsp;</div>-->
        <section class="content-header">
            <h1>
                Quản lý khoa viện
            </h1>
            <ol class="breadcrumb">
                <li>
                    <a href="#">Trang chủ</a>
                </li>
                <li class="active">
                    Quản lý khoa viện
                </li>
            </ol>
        </section>
        <div class="khung" data-width="5">
            <!--<div class="input">-->
                <!--<div class="label">Tên khoa/viện</div>-->
                <!--<input type="text"  value="">-->
            <!--</div>-->

            <!--<div class="input">-->
                <!--<div class="label">Mã khoa/viện</div>-->
                <!--<input type="text"  value="">-->
            <!--</div>-->

            <!--<a href="#" class="submit">Tìm kiếm</a>-->
            <!-- <div class="submit"></div> -->

            <form action="/admin/khoavien/tim-kiem" method="post">
                <div class="input">
                    <div class="label">Tên Khoa/viện</div>
                    <input type="text" name="tenKhoaVien" th:value="${tenKhoaVien}"/>
                    <br>
                </div>
                <div class="input">
                    <div class="label">Mã khoa/viện</div>
                    <input type="text" name="maKhoaVien" th:value="${maKhoaVien}"/><br>
                </div>
                <input type="submit"  class="submit" value="Tìm kiếm">
            </form>
        </div>
        <h3 class="title">
            Danh sách khoa viện
            <a href="#" class="add-use" data-toggle="modal" data-target="#themnhansu">
                <i class="fa fa-plus-circle" aria-hidden="true"></i>
                Thêm mới
            </a>
        </h3>
        <div class="table">
            <table class="tree-table">
                <thead class="fix-w text-center">
                <tr>
                    <th class="wpx-60">
                        <div>STT</div>
                    </th>
                    <th>
                        <div>
                            <div>Mã khoa viện</div>
                        </div>
                    </th>
                    <th>
                        <div>Tên khoa viện</div>
                    </th>
                    <th class="wpx-40">
                        <!-- <div>Chức năng</div> -->
                    </th>
                </tr>
                </thead>
                <tbody class="text-center">
                <th:block th:if="${#lists.isEmpty(lstKhoaVien)}">
                    <p>Không có dữ liệu</p>
                </th:block>
                <th:block th:if="${!#lists.isEmpty(lstKhoaVien)}">
                    <th:block th:each="kv, i : ${lstKhoaVien}">
                        <tr>
                            <td th:text="${i.index+1}">1</td>
                            <td th:text="${kv.maVien}"></td>
                            <td th:text="${kv.tenVien}"></td>
                            <td class="text-center">
                                <div class="dropdown bacham">
                                    <a href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
                                        <i class="fa fa-ellipsis-v" aria-hidden="true"></i>
                                    </a>
                                    <ul class="dropdown-menu dropdown-menu-right">
                                        <li class="inline">
                                            <a class="icon-edit" th:attr="idItem=${kv.maVien}"
                                               data-toggle="modal"
                                               data-target="#suanhansu"><i class="fa fa-pencil-square-o"
                                                                           aria-hidden="true"></i> Sửa</a></li>
                                        <!--<li class="inline">-->
                                            <!--<a class="icon-remove" th:attr="idItem=${kv.maVien}"><i-->
                                                    <!--class="fa fa-trash-o" aria-hidden="true"></i> Xóa</a>-->
                                        <!--</li>-->
                                    </ul>
                                </div>
                            </td>
                        </tr>

                    </th:block>
                </th:block>

                </tbody>
            </table>

        </div>
        </section>

        <!-- Modal themnhansu-->
        <div class="modal modal-full fade" id="themnhansu" role="dialog" aria-labelledby="themnhansuLabel">
            <div class="modal-dialog" role="document">
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span
                                aria-hidden="true">&times;</span></button>
                        <h3 class="modal-title" id="themnhansuLabel">
                            Thêm mới
                        </h3>
                    </div>
                    <div class="modal-body">
                        <form id="form-themmoi" th:action="@{/khoavien/them-moi}" method="post" class="form-horizontal">
                            <div class="">
                                <div class="row">
                                    <div class="col-md-6">
                                        <div class="form-group">
                                            <label for="" class="col-sm-3 control-label">Mã khoa viện <span class="red">(*)</span></label>
                                            <div class="col-md-9">
                                                <input required name="maVien" type="text" class="form-control" id=""
                                                       placeholder="Mã khoa viện">
                                            </div>
                                            <p class="col-sm-offset-3 help-block red">Example block-level help text
                                                here.</p>
                                        </div>
                                        <div class="form-group">
                                            <label for="" class="col-sm-3 control-label">Tên khoa viện <span
                                                    class="red">(*)</span></label>
                                            <div class="col-md-9">
                                                <input required name="tenVien" type="text" class="form-control" id=""
                                                       placeholder="Tên khoa viện ">
                                            </div>
                                            <p class="col-sm-offset-3 help-block red">Example block-level help text
                                                here.</p>
                                        </div>
                                        <input name="trangThai" value="1" hidden/>
                                    </div>

                                </div>

                            </div>

                        </form>
                    </div>
                    <div class="modal-footer text-center">
                        <button id="btn-themmoi" type="button" class="btn btn-primary"><i class="fa fa-plus-circle"
                                                                                          aria-hidden="true"></i> Thêm
                            mới
                        </button>
                        <button type="button" class="btn btn-default" data-dismiss="modal"><i class="fa fa-sign-out"
                                                                                              aria-hidden="true"></i>
                            Thoát
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Modal suanhansu-->
        <div class="modal modal-full fade" id="suanhansu" role="dialog" aria-labelledby="suanhansuLabel">
            <div class="modal-dialog" role="document">
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span
                                aria-hidden="true">&times;</span></button>
                        <h3 class="modal-title" id="suanhansuLabel">
                            Cập nhật
                        </h3>
                    </div>
                    <div class="modal-body">
                        <form id="form-sua" class="form-horizontal">
                            <div class="">
                                <div class="row">
                                    <div class="col-md-6">
                                        <div class="form-group">
                                            <label for="" class="col-sm-3 control-label">Mã khoa viện <span class="red">(*)</span></label>
                                            <div class="col-md-9">
                                                <input required name="maVien" readonly type="text" class="form-control"
                                                       id="maVienEdit"
                                                       placeholder="Mã khoa viện">
                                            </div>
                                            <p class="col-sm-offset-3 help-block red">Example block-level help text
                                                here.</p>
                                        </div>
                                        <div class="form-group">
                                            <label for="" class="col-sm-3 control-label">Tên khoa viện <span
                                                    class="red">(*)</span></label>
                                            <div class="col-md-9">
                                                <input required name="tenVien" type="text" class="form-control"
                                                       id="tenVienEdit"
                                                       placeholder="Tên khoa viện ">
                                            </div>
                                            <p class="col-sm-offset-3 help-block red">Example block-level help text
                                                here.</p>
                                        </div>

                                    </div>
                                </div>
                            </div>
                        </form>
                    </div>
                    <div class="modal-footer text-center">
                        <button id="btn-edit" type="button" class="btn btn-primary"><i class="fa fa-plus-circle"
                                                                                       aria-hidden="true"></i> Cập nhật
                        </button>
                        <button type="button" class="btn btn-default" data-dismiss="modal"><i class="fa fa-sign-out"
                                                                                              aria-hidden="true"></i>
                            Thoát
                        </button>
                    </div>
                </div>
            </div>
        </div>
        <!--test-->
    </div>

    <div th:replace="fragments/footer :: footer">&nbsp;</div>
</div>
</body>
<script th:inline="javascript">
    var base_url = [[@{/}]];

        $('#btn-themmoi').click(function () {
            var valid = $("#form-themmoi").parsley();
            valid.validate();
            if (valid.isValid()) {
                var data = $('#form-themmoi').serialize();
                $.ajax({
                    url: base_url + 'khoavien/them-moi',
                    type: "post",
                    data: data,
                    dataType: "text",
                    success: function (result) {
                        $('#themnhansu').modal('hide');
                        if (result.trim() === "success") {
                            notify_sucess('Thêm khoa viện', 'Thêm mới');
                        } else {
                            notify_error('Thêm khoa viện', 'Thêm mới');
                        }
                    }
                });
            }
        });
    //

    $('#btn-edit').click(function () {
        var valid = $("#form-sua").parsley();
        valid.validate();
        if (valid.isValid()) {
            var data = $('#form-sua').serialize();
            $.ajax({
                url: base_url + 'khoavien/cap-nhat',
                type: "post",
                data: data,
                dataType: "text",
                success: function (result) {
                    $('#suanhansu').modal('hide');
                    if (result.trim() === "success") {
                        notify_sucess('Cập nhật khoa viện', 'Cập nhật');
                    } else {
                        notify_error('Cập nhật khoa viện', 'Cập nhật');
                    }
                }
            });
        }
    });


    $('.icon-remove').click(function () {
        var idItem = $(this).attr("idItem");
        swal({
                title: "Cảnh báo",
                text: "Bạn có chắc muốn xóa danh mục này không!",
                type: "warning",
                showCancelButton: true,
                confirmButtonClass: "btn-danger",
                confirmButtonText: "Đồng ý",
                cancelButtonText: "Thoát!",
            },
            function (isConfirm) {
                if (isConfirm) {
                    $.ajax({
                        url: base_url + 'khoavien/xoa?id=' + idItem,
                        type: "post",
                        dataType: "text",
                        success: function (result) {
                            if (result.trim() === "success") {
                                notify_sucess('Xóa khoa viện', 'Xóa');
                            } else {
                                notify_error('Xóa khoa viện', 'Xóa');
                            }
                        }
                    });
                }
            });
    });

    $('.icon-edit').click(function () {
        var idItem = $(this).attr("idItem");
        $.ajax({
            url: base_url + 'khoavien/timkiem/' + idItem,
            type: "get",
            dataType: "text",
            success: function (result) {
                var rs = JSON.parse(result);
                $('#maVienEdit').val(rs.maVien);
                $('#tenVienEdit').val(rs.tenVien);
            }
        });
    });
</script>
</html>
